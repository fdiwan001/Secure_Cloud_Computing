(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{126:function(e,t,c){},127:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),a=c(55),s=c.n(a),o=c(0),l=c.n(o),i=c(3),d=c(18),u=c(140),j=c(133),b=c(136),h=c(134),O=c(25),p=c(74),f=(c(108),c(129),c(128),p.a.initializeApp({apiKey:"AIzaSyBAH9-MJRYq-CxBSZEo27cT5cT33ZVApo4",authDomain:"cloud-development-e159d.firebaseapp.com",databaseURL:"https://cloud-development-e159d-default-rtdb.firebaseio.com",projectId:"cloud-development-e159d",storageBucket:"cloud-development-e159d.appspot.com",messagingSenderId:"943901087032",appId:"1:943901087032:web:74d70fb08b50b4919b9dcd"})),x=f.firestore(),m={folders:x.collection("folders"),documents:x.collection("documents"),files:x.collection("files"),formatDoc:function(e){return Object(O.a)({id:e.id},e.data())},getCurrentTimestamp:p.a.firestore.FieldValue.serverTimestamp},v=(f.storage(),f.auth()),g=c(5),y=r.a.createContext();function w(){return Object(n.useContext)(y)}function F(e){var t=e.children,c=Object(n.useState)(),r=Object(d.a)(c,2),a=r[0],s=r[1],o=Object(n.useState)(!0),l=Object(d.a)(o,2),i=l[0],u=l[1];Object(n.useEffect)((function(){return v.onAuthStateChanged((function(e){s(e),u(!1)}))}),[]);var j={currentUser:a,login:function(e,t){return v.signInWithEmailAndPassword(e,t)},signup:function(e,t){return v.createUserWithEmailAndPassword(e,t)},logout:function(){return v.signOut()},resetPassword:function(e){return v.sendPasswordResetEmail(e)},updateEmail:function(e){return a.updateEmail(e)},updatePassword:function(e){return a.updatePassword(e)}};return Object(g.jsx)(y.Provider,{value:j,children:!i&&t})}var N=c(23),C=c(22),I=c(132);function S(e){var t=e.children;return Object(g.jsx)(I.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(g.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:t})})}function k(){var e=Object(n.useRef)(),t=Object(n.useRef)(),c=Object(n.useRef)(),r=w().signup,a=Object(n.useState)(""),s=Object(d.a)(a,2),o=s[0],O=s[1],p=Object(n.useState)(!1),f=Object(d.a)(p,2),x=f[0],m=f[1],v=Object(N.g)();function y(){return(y=Object(i.a)(l.a.mark((function n(a){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),t.current.value===c.current.value){n.next=3;break}return n.abrupt("return",O("Passwords do not match"));case 3:return n.prev=3,O(""),m(!0),n.next=8,r(e.current.value,t.current.value);case 8:v.push("/"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),O("Failed to create an account");case 14:m(!1);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))).apply(this,arguments)}return Object(g.jsxs)(S,{children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(u.a.Body,{children:[Object(g.jsx)("h2",{className:"text-center mb-4",children:"Sign Up"}),o&&Object(g.jsx)(j.a,{variant:"danger",children:o}),Object(g.jsxs)(b.a,{onSubmit:function(e){return y.apply(this,arguments)},children:[Object(g.jsxs)(b.a.Group,{id:"email",children:[Object(g.jsx)(b.a.Label,{children:"Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(g.jsxs)(b.a.Group,{id:"password",children:[Object(g.jsx)(b.a.Label,{children:"Password"}),Object(g.jsx)(b.a.Control,{type:"password",ref:t,required:!0})]}),Object(g.jsxs)(b.a.Group,{id:"password-confirm",children:[Object(g.jsx)(b.a.Label,{children:"Password Confirmation"}),Object(g.jsx)(b.a.Control,{type:"password",ref:c,required:!0})]}),Object(g.jsx)(h.a,{disabled:x,className:"w-100",type:"submit",children:"Sign Up"})]})]})}),Object(g.jsxs)("div",{className:"w-100 text-center mt-2",children:["Already have an account? ",Object(g.jsx)(C.b,{to:"/login",children:"Log In"})]})]})}function E(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),c=t[0],r=t[1],a=w(),s=a.currentUser,o=a.logout,b=Object(N.g)();function O(){return(O=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(""),e.prev=1,e.next=4,o();case 4:b.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),r("Failed to log out");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return Object(g.jsxs)(S,{children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(u.a.Body,{children:[Object(g.jsx)("h2",{className:"text-center mb-4",children:"Profile"}),c&&Object(g.jsx)(j.a,{variant:"danger",children:c}),Object(g.jsx)("strong",{children:"Email:"})," ",s.email,Object(g.jsx)(C.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3",children:"Update Profile"})]})}),Object(g.jsx)("div",{className:"w-100 text-center mt-2",children:Object(g.jsx)(h.a,{variant:"link",onClick:function(){return O.apply(this,arguments)},children:"Log Out"})})]})}function P(){var e=Object(n.useRef)(),t=Object(n.useRef)(),c=w().login,r=Object(n.useState)(""),a=Object(d.a)(r,2),s=a[0],o=a[1],O=Object(n.useState)(!1),f=Object(d.a)(O,2),x=f[0],m=f[1],v=Object(N.g)();function y(){return(y=Object(i.a)(l.a.mark((function n(r){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,o(""),m(!0),n.next=6,c(e.current.value,t.current.value);case 6:v.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),o("Failed to log in");case 12:m(!1);case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))).apply(this,arguments)}return Object(g.jsxs)(S,{children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(u.a.Body,{children:[Object(g.jsx)("h2",{className:"text-center mb-4",children:"Log In"}),s&&Object(g.jsx)(j.a,{variant:"danger",children:s}),Object(g.jsxs)(b.a,{onSubmit:function(e){return y.apply(this,arguments)},children:[Object(g.jsxs)(b.a.Group,{id:"email",children:[Object(g.jsx)(b.a.Label,{children:"Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(g.jsxs)(b.a.Group,{id:"password",children:[Object(g.jsx)(b.a.Label,{children:"Password"}),Object(g.jsx)(b.a.Control,{type:"password",ref:t,required:!0})]}),Object(g.jsx)(h.a,{disabled:x,className:"w-100",type:"submit",children:"Log In"}),Object(g.jsxs)(h.a,{variant:"light",className:"w-100",onClick:function(){var e=new p.a.auth.GoogleAuthProvider;p.a.auth().signInWithPopup(e).then((function(e){o(""),m(!0),console.log(e),v.push("/")})).catch((function(e){console.log(e)})),m(!1)},children:[Object(g.jsx)("img",{src:"https://img.icons8.com/external-justicon-flat-justicon/64/000000/external-google-social-media-justicon-flat-justicon.png",alt:"google icon"}),Object(g.jsx)("span",{children:" Continue with Google"})]})]}),Object(g.jsx)("div",{className:"w-100 text-center mt-3",children:Object(g.jsx)(C.b,{to:"/forgot-password",children:"Forgot Password?"})})]})}),Object(g.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(g.jsx)(C.b,{to:"/signup",children:"Sign Up"})]})]})}var L=c(102),D=["component"];function R(e){var t=e.component,c=Object(L.a)(e,D),n=w().currentUser;return Object(g.jsx)(N.b,Object(O.a)(Object(O.a)({},c),{},{render:function(e){return n?Object(g.jsx)(t,Object(O.a)({},e)):Object(g.jsx)(N.a,{to:"/login"})}}))}function U(){var e=Object(n.useRef)(),t=w().resetPassword,c=Object(n.useState)(""),r=Object(d.a)(c,2),a=r[0],s=r[1],o=Object(n.useState)(""),O=Object(d.a)(o,2),p=O[0],f=O[1],x=Object(n.useState)(!1),m=Object(d.a)(x,2),v=m[0],y=m[1];function F(){return(F=Object(i.a)(l.a.mark((function c(n){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n.preventDefault(),c.prev=1,f(""),s(""),y(!0),c.next=7,t(e.current.value);case 7:f("Check your inbox for further instructions"),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(1),s("Failed to reset password");case 13:y(!1);case 14:case"end":return c.stop()}}),c,null,[[1,10]])})))).apply(this,arguments)}return Object(g.jsxs)(S,{children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(u.a.Body,{children:[Object(g.jsx)("h2",{className:"text-center mb-4",children:"Password Reset"}),a&&Object(g.jsx)(j.a,{variant:"danger",children:a}),p&&Object(g.jsx)(j.a,{variant:"success",children:p}),Object(g.jsxs)(b.a,{onSubmit:function(e){return F.apply(this,arguments)},children:[Object(g.jsxs)(b.a.Group,{id:"email",children:[Object(g.jsx)(b.a.Label,{children:"Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:e,required:!0})]}),Object(g.jsx)(h.a,{disabled:v,className:"w-100",type:"submit",children:"Reset Password"})]}),Object(g.jsx)("div",{className:"w-100 text-center mt-3",children:Object(g.jsx)(C.b,{to:"/login",children:"Login"})})]})}),Object(g.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(g.jsx)(C.b,{to:"/signup",children:"Sign Up"})]})]})}function q(){var e=Object(n.useRef)(),t=Object(n.useRef)(),c=Object(n.useRef)(),r=w(),a=r.currentUser,s=r.updatePassword,o=r.updateEmail,l=Object(n.useState)(""),i=Object(d.a)(l,2),O=i[0],p=i[1],f=Object(n.useState)(!1),x=Object(d.a)(f,2),m=x[0],v=x[1],y=Object(N.g)();return Object(g.jsxs)(S,{children:[Object(g.jsx)(u.a,{children:Object(g.jsxs)(u.a.Body,{children:[Object(g.jsx)("h2",{className:"text-center mb-4",children:"Update Profile"}),O&&Object(g.jsx)(j.a,{variant:"danger",children:O}),Object(g.jsxs)(b.a,{onSubmit:function(n){if(n.preventDefault(),t.current.value!==c.current.value)return p("Passwords do not match");var r=[];v(!0),p(""),e.current.value!==a.email&&r.push(o(e.current.value)),t.current.value&&r.push(s(t.current.value)),Promise.all(r).then((function(){y.push("/user")})).catch((function(){p("Failed to update account")})).finally((function(){v(!1)}))},children:[Object(g.jsxs)(b.a.Group,{id:"email",children:[Object(g.jsx)(b.a.Label,{children:"Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:e,required:!0,defaultValue:a.email})]}),Object(g.jsxs)(b.a.Group,{id:"password",children:[Object(g.jsx)(b.a.Label,{children:"Password"}),Object(g.jsx)(b.a.Control,{type:"password",ref:t,placeholder:"Leave blank to keep the same"})]}),Object(g.jsxs)(b.a.Group,{id:"password-confirm",children:[Object(g.jsx)(b.a.Label,{children:"Password Confirmation"}),Object(g.jsx)(b.a.Control,{type:"password",ref:c,placeholder:"Leave blank to keep the same"})]}),Object(g.jsx)(h.a,{disabled:m,className:"w-100",type:"submit",children:"Update"})]})]})}),Object(g.jsx)("div",{className:"w-100 text-center mt-2",children:Object(g.jsx)(C.b,{to:"/user",children:"Cancel"})})]})}var B=c(24),G=c(94),A=c.n(G),T=(c(122),c(83)),W=c(41),z=c(135),M=c(40),H=c(98),J=[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{align:[]}],["image","blockquote","code-block"],["clean"]];function V(){var e=Object(N.i)().id,t=Object(n.useState)(),c=Object(d.a)(t,2),r=c[0],a=c[1],s=Object(n.useState)(),o=Object(d.a)(s,2),u=o[0],j=o[1],O=w().currentUser;console.log(e),console.log("current user is ",O.uid);var p=[];p.push(O.uid);var f=Object(n.useState)(!1),m=Object(d.a)(f,2),v=m[0],y=m[1],F=Object(n.useRef)(),C=Object(n.useState)(""),I=Object(d.a)(C,2),S=I[0],k=I[1],E={userid:p,id:e};function P(){y(!1)}var L=function(){var t=Object(i.a)(l.a.mark((function t(c){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,n=x.collection("documents").doc(e),console.log(S),t.next=6,n.set({name:S},{merge:!0});case 6:t.sent,console.log(S),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0);case 13:P();case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){var e=Object(T.a)("http://localhost:3001");return a(e),function(){e.disconnect()}}),[]),Object(n.useEffect)((function(){null!=r&&null!=u&&(r.once("load-document",(function(e){console.log(e),u.setContents(e),u.enable()})),r.emit("get-document",E))}),[r,u,E]),Object(n.useEffect)((function(){if(null!=r&&null!=u){var e=setInterval((function(){r.emit("save-document",u.getContents())}),2e3);return function(){clearInterval(e)}}}),[r,u]),Object(n.useEffect)((function(){if(null!=r&&null!=u){var e=function(e,t,c){"user"===c&&r.emit("send-changes",e)};return u.on("text-change",e),function(){u.off("text-change",e)}}}),[r,u]),Object(n.useEffect)((function(){if(null!=r&&null!=u){var e=function(e){u.updateContents(e)};return r.on("receive-changes",e),function(){r.off("receive-changes",e)}}}),[r,u]);var D=Object(n.useCallback)((function(e){if(null!=e){e.innerHTML="";var t=document.createElement("div");e.append(t);var c=new A.a(t,{theme:"snow",modules:{toolbar:J}});c.disable(),c.setText("Loading ..."),j(c)}}),[]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(H.a,{children:[Object(g.jsx)("link",{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css",integrity:"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T",crossorigin:"anonymous"}),Object(g.jsx)("script",{src:"https://code.jquery.com/jquery-3.3.1.slim.min.js",integrity:"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo",crossorigin:"anonymous"}),Object(g.jsx)("script",{src:"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js",integrity:"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1",crossorigin:"anonymous"}),Object(g.jsx)("script",{src:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js",integrity:"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM",crossorigin:"anonymous"})]}),Object(g.jsx)("button",{type:"button",className:"btn btn-primary","data-toggle":"modal","data-target":"#exampleModal",children:"Rename File"}),Object(g.jsx)("div",{className:"modal fade",id:"exampleModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(g.jsx)("div",{className:"modal-dialog",role:"document",children:Object(g.jsxs)("div",{className:"modal-content",children:[Object(g.jsxs)("div",{className:"modal-header",children:[Object(g.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"File Name"}),Object(g.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(g.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(g.jsxs)(b.a,{onSubmit:L,children:[Object(g.jsx)("div",{className:"modal-body",children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"Document Name"}),Object(g.jsx)(b.a.Control,{type:"text",required:!0,value:S,onChange:function(e){return k(e.target.value)}})]})}),Object(g.jsxs)("div",{className:"modal-footer",children:[Object(g.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Close"}),Object(g.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save changes"})]})]})]})})}),Object(g.jsx)(h.a,{onClick:function(){y(!0)},variant:"outline-success",size:"sm",children:Object(g.jsx)(M.a,{icon:W.e})}),Object(g.jsx)(z.a,{show:v,onHide:P,children:Object(g.jsxs)(b.a,{onSubmit:function(t){t.preventDefault(),console.log("email is ",F.current.value),console.log("email is ",F.current.value),x.collection("users").doc(F.current.value).get().then((function(t){var c=[];c.push(t.data().userid);var n=[];n.push(O.uid),c=[].concat(Object(B.a)(c),n),console.log("user is ",c),x.collection("documents").doc(e).update({userId:c,shared:"yes"})})),P()},children:[Object(g.jsx)(z.a.Body,{children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"User Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:F,required:!0})]})}),Object(g.jsxs)(z.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:P,children:"Close"}),Object(g.jsx)(h.a,{variant:"success",type:"submit",children:"Enter"})]})]})}),Object(g.jsx)("div",{className:"container",ref:D})]})}var Q="select-folder",X="update-folder",Z="set-child-folders",K="set-child-files",Y={name:"My Drive",id:null,path:[]};function _(e,t){var c=t.type,n=t.payload;switch(c){case Q:return{folderId:n.folderId,folder:n.folder,childFiles:[],childFolders:[]};case X:return Object(O.a)(Object(O.a)({},e),{},{folder:n.folder});case Z:return Object(O.a)(Object(O.a)({},e),{},{childFolders:n.childFolders});case K:return Object(O.a)(Object(O.a)({},e),{},{childFiles:n.childFiles});default:return e}}function $(e){var t=e.currentFolder,c=Object(n.useState)(!1),r=Object(d.a)(c,2),a=r[0],s=r[1],o=Object(n.useState)(""),l=Object(d.a)(o,2),i=l[0],u=l[1],j=w().currentUser;function O(){s(!1)}return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(h.a,{onClick:function(){s(!0)},variant:"outline-success",size:"sm",children:Object(g.jsx)(M.a,{icon:W.d})}),Object(g.jsx)(z.a,{show:a,onHide:O,children:Object(g.jsxs)(b.a,{onSubmit:function(e){if(e.preventDefault(),console.log("adding folder started"),null!=t){var c=Object(B.a)(t.path),n=[],r=[t.id];console.log("sharepath is ",r),n.push(j.uid),t!==Y?(c.push({name:t.name,id:t.id}),x.collection("folders").doc(t.id).get().then((function(e){r=[].concat(Object(B.a)(r),Object(B.a)(e.data().sharepath)),m.folders.add({name:i,parentId:t.id,userId:e.data().userId,shared:e.data().shared,path:c,sharepath:r,ownerId:j.uid,createdAt:m.getCurrentTimestamp()})})),u(""),O()):(m.folders.add({name:i,parentId:t.id,userId:n,shared:null,sharepath:r,path:c,ownerId:j.uid,createdAt:m.getCurrentTimestamp()}),u(""),O(),console.log("current user is not null"),console.log("current folder id is",t.id))}},children:[Object(g.jsx)(z.a.Body,{children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"Folder Name"}),Object(g.jsx)(b.a.Control,{type:"text",required:!0,value:i,onChange:function(e){return u(e.target.value)}})]})}),Object(g.jsxs)(z.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:O,children:"Close"}),Object(g.jsx)(h.a,{variant:"success",type:"submit",children:"Add Folder"})]})]})})]})}function ee(e){var t=e.currentFolder,c=Object(n.useState)(!1),r=Object(d.a)(c,2),a=r[0],s=r[1],o=Object(n.useState)(""),l=Object(d.a)(o,2),i=l[0],u=l[1],j=Object(n.useState)(),O=Object(d.a)(j,2),p=O[0],f=O[1];w().currentUser;function x(){s(!1)}return Object(n.useEffect)((function(){var e=Object(T.a)("http://localhost:3001");return f(e),function(){e.disconnect()}}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(h.a,{onClick:function(){s(!0)},variant:"outline-success",size:"sm",children:Object(g.jsx)(M.a,{icon:W.b})}),Object(g.jsx)(z.a,{show:a,onHide:x,children:Object(g.jsxs)(b.a,{onSubmit:function(){var e=t.id;p.emit("document-name",i),p.emit("folderId",e),u(""),x()},children:[Object(g.jsx)(z.a.Body,{children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"Document Name"}),Object(g.jsx)(b.a.Control,{type:"text",required:!0,value:i,onChange:function(e){return u(e.target.value)}})]})}),Object(g.jsxs)(z.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:x,children:"Close"}),Object(g.jsx)(C.b,{target:"_blank",to:"/create",children:Object(g.jsx)(h.a,{variant:"success",type:"button",children:"Create Document"})})]})]})})]})}function te(e){var t=e.currentFolder,c=Object(n.useState)(!1),r=Object(d.a)(c,2),a=r[0],s=r[1],o=w().currentUser,l=Object(n.useRef)();function i(){s(!1)}return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(h.a,{onClick:function(){s(!0)},variant:"outline-success",size:"sm",children:Object(g.jsx)(M.a,{icon:W.e})}),Object(g.jsx)(z.a,{show:a,onHide:i,children:Object(g.jsxs)(b.a,{onSubmit:function(e){e.preventDefault();try{if(null==t)return console.log("current user is null");m.folders.where("sharepath","array-contains",t.id).get().then((function(e){e.forEach((function(e){x.collection("users").doc(l.current.value).get().then((function(c){var n=[];n.push(c.data().userid);var r=[];r.push(o.uid),n=[].concat(Object(B.a)(n),r),x.collection("folders").doc(e.id).update({userId:n,shared:"yes"}),x.collection("folders").doc(t.id).update({userId:n,shared:"yes"})}))}))}))}catch(c){console.log("Failed to share")}i()},children:[Object(g.jsx)(z.a.Body,{children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"User Email"}),Object(g.jsx)(b.a.Control,{type:"email",ref:l,required:!0})]})}),Object(g.jsxs)(z.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:i,children:"Close"}),Object(g.jsx)(h.a,{variant:"success",type:"submit",children:"Enter"})]})]})})]})}function ce(e){var t=e.folder;return Object(g.jsxs)(h.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"secondary",className:"text-truncate w-100",as:C.b,children:[Object(g.jsx)(M.a,{icon:W.c,className:"mr-2"}),t.name]})}function ne(e){var t=e.file;return Object(g.jsxs)(h.a,{to:{pathname:"/documents/".concat(t.docId)},target:"_blank",variant:"secondary",className:"text-truncate w-100",as:C.b,children:[Object(g.jsx)(M.a,{icon:W.a,className:"mr-2"}),t.name]})}var re=c(139),ae=c(137);function se(){return Object(g.jsxs)(re.a,{bg:"primary",variant:"dark",expand:!1,children:[Object(g.jsx)(re.a.Brand,{as:C.b,to:"/",children:"SCC Drive"}),Object(g.jsx)(ae.a,{children:Object(g.jsx)(ae.a.Link,{as:C.b,to:"/user",children:"Profile"})}),Object(g.jsx)(ae.a,{children:Object(g.jsx)(ae.a.Link,{as:C.b,to:"/shared",children:"Shared"})}),Object(g.jsx)(ae.a,{children:Object(g.jsx)(ae.a.Link,{as:C.b,target:"_blank",to:"/create",children:"Document"})})]})}var oe=c(141);function le(e){var t=e.currentFolder,c=t===Y?[]:[Y];return console.log("current path is ",c),t&&(c=[].concat(Object(B.a)(c),Object(B.a)(t.path))),console.log("currentFolder.path is ",c),Object(g.jsxs)(oe.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"},children:[c.map((function(e,t){return Object(g.jsx)(oe.a.Item,{linkAs:C.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(O.a)(Object(O.a)({},e),{},{path:c.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:e.name},e.id)})),t&&Object(g.jsx)(oe.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0,children:t.name})]})}function ie(){var e=Object(N.i)().folderId,t=Object(N.h)().state,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=Object(n.useReducer)(_,{folderId:e,folder:t,childFolders:[],childFiles:[]}),r=Object(d.a)(c,2),a=r[0],s=r[1],o=w().currentUser;return Object(n.useEffect)((function(){s({type:Q,payload:{folderId:e,folder:t}})}),[e,t]),Object(n.useEffect)((function(){if(null==e)return s({type:X,payload:{folder:Y}});m.folders.doc(e).get().then((function(e){s({type:X,payload:{folder:m.formatDoc(e)}})})).catch((function(){s({type:X,payload:{folder:Y}})}))}),[e]),Object(n.useEffect)((function(){return m.folders.where("parentId","==",e).where("userId","array-contains",o.uid).onSnapshot((function(e){s({type:Z,payload:{childFolders:e.docs.map(m.formatDoc)}})}))}),[e,o]),Object(n.useEffect)((function(){return m.documents.where("userId","array-contains",o.uid).onSnapshot((function(e){s({type:K,payload:{childFiles:e.docs.map(m.formatDoc)}})}))}),[e,o]),a}(e,(void 0===t?{}:t).folder),r=c.folder,a=c.childFolders,s=c.childFiles,o=w().currentUser;return null!==o&&x.collection("users").doc(o.email).set({email:o.email,userid:o.uid}),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(se,{}),Object(g.jsxs)(I.a,{fluid:!0,children:[Object(g.jsxs)("div",{className:"d-flex align-items-center",children:[Object(g.jsx)(le,{currentFolder:r}),Object(g.jsx)(ee,{currentFolder:r}),Object(g.jsx)($,{currentFolder:r}),Object(g.jsx)(te,{currentFolder:r})]}),a.length>0&&Object(g.jsx)("div",{className:"d-flex flex-wrap",children:a.map((function(e){return Object(g.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(g.jsx)(ce,{folder:e})},e.id)}))}),a.length>0&&s.length>0&&Object(g.jsx)("hr",{}),s.length>0&&Object(g.jsx)("div",{className:"d-flex flex-wrap",children:s.map((function(e){return Object(g.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(g.jsx)(ne,{file:e})},e.id)}))})]})]})}var de="select-folder",ue="update-folder",je="set-child-folders",be="set-child-files",he={name:"Shared Drive",id:null,path:[]};function Oe(e,t){var c=t.type,n=t.payload;switch(c){case de:return{folderId:n.folderId,folder:n.folder,childFiles:[],childFolders:[]};case ue:return Object(O.a)(Object(O.a)({},e),{},{folder:n.folder});case je:return Object(O.a)(Object(O.a)({},e),{},{childFolders:n.childFolders});case be:return Object(O.a)(Object(O.a)({},e),{},{childFiles:n.childFiles});default:return e}}function pe(){var e=Object(N.i)().folderId,t=Object(N.h)().state,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=Object(n.useReducer)(Oe,{folderId:e,folder:t,childFolders:[],childFiles:[]}),r=Object(d.a)(c,2),a=r[0],s=r[1],o=w().currentUser;return Object(n.useEffect)((function(){s({type:de,payload:{folderId:e,folder:t}})}),[e,t]),Object(n.useEffect)((function(){if(null===e)return s({type:ue,payload:{folder:he}});m.folders.doc(e).get().then((function(e){s({type:ue,payload:{folder:m.formatDoc(e)}})})).catch((function(){s({type:ue,payload:{folder:he}})}))}),[e]),Object(n.useEffect)((function(){return console.log("retriving database child folders and folderId is",e),console.log("current user id is ",o.uid),m.folders.where("shared","==","yes").where("ownerId","==",o.uid).orderBy("createdAt").onSnapshot((function(e){s({type:je,payload:{childFolders:e.docs.map(m.formatDoc)}})}))}),[e,o]),Object(n.useEffect)((function(){return console.log("retriving database child files"),m.files.where("shared","==","yes").where("ownerId","==",o.uid).orderBy("createdAt").onSnapshot((function(e){s({type:be,payload:{childFiles:e.docs.map(m.formatDoc)}})}))}),[e,o]),a}(e,(void 0===t?{}:t).folder),r=c.childFolders,a=c.childFiles;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(se,{}),Object(g.jsxs)(I.a,{fluid:!0,children:[r.length>0&&Object(g.jsx)("div",{className:"d-flex flex-wrap",children:r.map((function(e){return Object(g.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(g.jsx)(ce,{folder:e})},e.id)}))}),r.length>0&&a.length>0&&Object(g.jsx)("hr",{}),a.length>0&&Object(g.jsx)("div",{className:"d-flex flex-wrap",children:a.map((function(e){return Object(g.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(g.jsx)(ne,{file:e})},e.id)}))})]})]})}function fe(){return Object(g.jsx)(V,{})}var xe=c(138);var me=function(){return Object(g.jsx)(C.a,{children:Object(g.jsx)(F,{children:Object(g.jsxs)(N.d,{children:[Object(g.jsx)(R,{exact:!0,path:"/",component:ie}),Object(g.jsx)(R,{exact:!0,path:"/folder/:folderId",component:ie}),Object(g.jsx)(R,{exact:!0,path:"/viewall",component:fe}),Object(g.jsx)(R,{exact:!0,path:"/create",children:Object(g.jsx)(N.a,{to:"/documents/".concat(Object(xe.a)())})}),Object(g.jsx)(R,{exact:!0,path:"/documents/:id",component:V}),Object(g.jsx)(R,{path:"/shared",component:pe}),Object(g.jsx)(R,{path:"/folder/:folderId",component:pe}),Object(g.jsx)(R,{path:"/user",component:E}),Object(g.jsx)(R,{path:"/update-profile",component:q}),Object(g.jsx)(N.b,{path:"/signup",component:k}),Object(g.jsx)(N.b,{path:"/login",component:P}),Object(g.jsx)(N.b,{path:"/forgot-password",component:U})]})})})};c(125),c(126);s.a.render(Object(g.jsx)(me,{}),document.getElementById("root"))}},[[127,1,2]]]);
//# sourceMappingURL=main.52e6b698.chunk.js.map