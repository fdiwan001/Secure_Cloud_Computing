{"ast":null,"code":"import _toConsumableArray from\"/home/kali/Desktop/Secure_Cloud_Computing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/kali/Desktop/Secure_Cloud_Computing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Button,Modal,Form}from\"react-bootstrap\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faFolderPlus}from\"@fortawesome/free-solid-svg-icons\";import{database,firestore}from\"../../firebase\";import{useAuth}from\"../../contexts/AuthContext\";import{ROOT_FOLDER}from\"../../hooks/useFolder\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function AddFolder(_ref){var currentFolder=_ref.currentFolder;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useAuth=useAuth(),currentUser=_useAuth.currentUser;function openModal(){setOpen(true);}function closeModal(){setOpen(false);}function handleSubmit(e){e.preventDefault();console.log(\"adding folder started\");if(currentFolder==null)return;var path=_toConsumableArray(currentFolder.path);var user=[];var sharepath=[currentFolder.id];console.log(\"sharepath is \",sharepath);user.push(currentUser.uid);if(currentFolder!==ROOT_FOLDER){path.push({name:currentFolder.name,id:currentFolder.id});firestore.collection('folders').doc(currentFolder.id).get().then(function(doc){sharepath=[].concat(_toConsumableArray(sharepath),_toConsumableArray(doc.data().sharepath));database.folders.add({name:name,parentId:currentFolder.id,userId:doc.data().userId,shared:doc.data().shared,path:path,sharepath:sharepath,ownerId:currentUser.uid,createdAt:database.getCurrentTimestamp()});});setName(\"\");closeModal();}else{database.folders.add({name:name,parentId:currentFolder.id,userId:user,shared:null,sharepath:sharepath,path:path,ownerId:currentUser.uid,createdAt:database.getCurrentTimestamp()});setName(\"\");closeModal();console.log(\"current user is not null\");console.log(\"current folder id is\",currentFolder.id);}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{onClick:openModal,variant:\"outline-success\",size:\"sm\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFolderPlus})}),/*#__PURE__*/_jsx(Modal,{show:open,onHide:closeModal,children:/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Folder Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",required:true,value:name,onChange:function onChange(e){return setName(e.target.value);}})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:closeModal,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",type:\"submit\",children:\"Add Folder\"})]})]})})]});}","map":{"version":3,"sources":["/home/kali/Desktop/Secure_Cloud_Computing/src/Component/Drive/AddFolder.js"],"names":["React","useState","Button","Modal","Form","FontAwesomeIcon","faFolderPlus","database","firestore","useAuth","ROOT_FOLDER","AddFolder","currentFolder","open","setOpen","name","setName","currentUser","openModal","closeModal","handleSubmit","e","preventDefault","console","log","path","user","sharepath","id","push","uid","collection","doc","get","then","data","folders","add","parentId","userId","shared","ownerId","createdAt","getCurrentTimestamp","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\nimport { Button, Modal, Form } from \"react-bootstrap\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { faFolderPlus} from \"@fortawesome/free-solid-svg-icons\"\nimport { database, firestore } from \"../../firebase\"\nimport { useAuth } from \"../../contexts/AuthContext\"\nimport { ROOT_FOLDER } from \"../../hooks/useFolder\"\n\nexport default function AddFolder({ currentFolder }) {\n  const [open, setOpen] = useState(false)\n  const [name, setName] = useState(\"\")\n  const { currentUser } = useAuth()\n\n  function openModal() {\n    setOpen(true)\n  }\n\n  function closeModal() {\n    setOpen(false)\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault()\n\n    console.log(\"adding folder started\")\n\n    if (currentFolder == null) return\n\n    const path = [...currentFolder.path]\n    const user = []\n    var sharepath = [currentFolder.id];\n    console.log(\"sharepath is \", sharepath)\n    user.push(currentUser.uid)\n    if (currentFolder !== ROOT_FOLDER) {\n      path.push({ name: currentFolder.name, id: currentFolder.id })\n\n      firestore.collection('folders').doc(currentFolder.id).get().then(doc => {\n\n        sharepath = [...sharepath, ...doc.data().sharepath]\n\n      database.folders.add({\n        name: name,\n        parentId: currentFolder.id,\n        userId: doc.data().userId,\n        shared: doc.data().shared,\n        path: path,\n        sharepath: sharepath,\n        ownerId: currentUser.uid,\n        createdAt: database.getCurrentTimestamp(),\n      })\n    })\n      setName(\"\")\n      closeModal()\n    }\n    else{\n      database.folders.add({\n      name: name,\n      parentId: currentFolder.id,\n      userId: user,\n      shared: null,\n      sharepath: sharepath,\n      path: path,\n      ownerId: currentUser.uid,\n      createdAt: database.getCurrentTimestamp(),\n    })\n    setName(\"\")\n    closeModal()\n\n\n    console.log(\"current user is not null\")\n    console.log(\"current folder id is\", currentFolder.id)\n\n    }\n    \n  }\n\n\n  return (\n    <>\n      <Button onClick={openModal} variant=\"outline-success\" size=\"sm\">\n        <FontAwesomeIcon icon={faFolderPlus} />\n      </Button>\n      <Modal show={open} onHide={closeModal}>\n        <Form onSubmit={handleSubmit}>\n          <Modal.Body>\n            <Form.Group>\n              <Form.Label>Folder Name</Form.Label>\n              <Form.Control\n                type=\"text\"\n                required\n                value={name}\n                onChange={e => setName(e.target.value)}\n              />\n            </Form.Group>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={closeModal}>\n              Close\n            </Button>\n            <Button variant=\"success\" type=\"submit\">\n              Add Folder\n            </Button>\n          </Modal.Footer>\n        </Form>\n      </Modal>\n    </>\n  )\n}"]},"metadata":{},"sourceType":"module"}